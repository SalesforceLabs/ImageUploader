# ImageUploader

**⭐️ 操作マニュアルはコチラ ↓**

[https://salesforce.quip.com/aV5yATMhaA96](https://salesforce.quip.com/aV5yATMhaA96)

**⭐️ 詳細な設定マニュアルはコチラ ↓**

[https://salesforce.quip.com/wqkJANnbuwgp](https://salesforce.quip.com/wqkJANnbuwgp)

## １．パッケージのインストール

### １-２. インストール URL を開く

・AppExchange URL

[https://appexchange.salesforce.com/appxListingDetail?listingId=a0N3u00000MRwSJEA1](https://appexchange.salesforce.com/appxListingDetail?listingId=a0N3u00000MRwSJEA1)

### １-２. ログイン

ログイン画面が開かれた場合、自身のログイン ID・パスワードを入力する

<img src="https://i.imgur.com/LPS8aYE.png" alt="ログインイメージ" width="400" />

### １-３. 利用ユーザの選択

以下から利用用途に合わせて選び、インストールボタンを押下する。
※インストール後に利用ユーザを設定することも可能

<img src="https://i.imgur.com/gJ6gW64.png" alt="インストールイメージ" width="600" />

| ケース                               | インストール                     |
| ------------------------------------ | -------------------------------- |
| システム管理者のみが試験導入する場合 | 管理者のみインストール           |
| すべてのユーザが利用する場合         | すべてのユーザのインストール     |
| 特定のユーザのみが利用する場合       | 特定のプロファイルのインストール |

### １-４. インストール完了

インストールの完了メッセージが表示された場合、完了ボタンを押下する。

<img src="https://i.imgur.com/9p4z4h5.png" alt="インストール完了" width="600" />

設定内の「インストール済みパッケージ」に Image Uploader が追加されます。

<img src="https://i.imgur.com/XVbR4b4.png" alt="インストール済みパッケージの確認" width="600" />

## ２．レコードページへの追加

_社内向けで利用する場合、任意のオブジェクトに以下設定を行ってください_

### ２-１. 編集ページを開く

追加したいオブジェクトのレコードを開き、画面右上の「歯車マーク → 編集ページ」の順に押下する。

<img src="https://i.imgur.com/zNI7MCa.png" alt="編集ページの設定" width="600" />

### ２-２. コンポーネントを配置

画面左のコンポーネントから、「カスタム-管理」セクションにある「Image Uploader」をページ内の配置したい箇所にドラッグ＆ドロップします。
（Image Uploader(パーツのため使用不可)は、モバイルアプリで使用されるコンポーネントのパーツのため単体では動作しません）

<img src="https://i.imgur.com/k17U8kJ.png" alt="コンポーネントの配置" width="600" />

### ２-３. 詳細設定

画面右側の詳細設定にて、利用したい条件に合わせて設定を変更します。
コンポーネント設定の詳細は[こちら](https://salesforce.quip.com/wqkJANnbuwgp#YDcACAkKq3W)から確認ください。

## ３．動画・音声ファイルの再生設定

Image Uploader はファイルの拡張子によって表示の実行動作を変えています。
以下はコンポーネント内でのファイルの取り扱いの設定であり、動作の実行を保証するものではありません。
各ファイルの実行はデバイスやブラウザの実装に依存しますのでご注意ください。
webm や ogg など、対応拡張子を増やしたい場合はコンポーネントの改修が必要になります。

| 種別         | コンポーネント上での挙動                                                 |
| ------------ | ------------------------------------------------------------------------ |
| 動画ファイル | 拡張子が avi/mpeg/mp4/mov/wmv のファイルは動画ファイルとして扱われます。 |
| 音声ファイル | 拡張子が mp3/acc/wav/wma のファイルは音声ファイルとして扱われます。      |

**動画・音声ファイルを再生させるための設定**

- 設定>セキュリティ>CSP 信頼済みサイト →「新規作成」として、次のように自ドメインからの*media-src*を有効にする
  - 信頼済みサイト名: 任意の名前
  - 信頼済みサイト URL: マイドメインを有効にした組織の URL
    例: https://XXXXXXXXX.my.salesforce.com
  - 有効: チェックを入れる
  - コンテキスト: すべて (Salesforce+デジタルエクスペリエンスサイト) もしくは LEX (Salesforce)またはコミュニティ(デジタルエクスペリエンスサイト)
  - CSP ディレクティブ
    “media-src のサイトを許可”にチェックを入れる

## ４．PDF ファイルの表示設定

**PDF を表示させるための設定**

- 設定>セキュリティ>ファイルのアップロードおよびダウンロードセキュリティ →.pdf のダウンロード操作を“ブラウザで実行”に変更
